generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Account {
  id       Int    @id @default(autoincrement())
  email    String @unique
  password String
  role     String

  @@map("accounts")
}

model Student {
  id              Int              @id @default(autoincrement())
  email           String           @unique
  name            String
  parentName      String
  contact         String
  age             Int
  grade           String
  className       String
  teacher         String
  totalSessions   Int
  attended        Int
  fee             String
  del_flg         Int?
  awards          Award[]
  evaluations     Evaluation[]
  progresses      Progress[]
  scheduleItems   ScheduleItem[]
  yearlySchedules YearlySchedule[]

  @@map("student")
}

model ScheduleItem {
  id           Int     @id @default(autoincrement())
  day          String
  time         String
  subject      String
  location     String
  studentEmail String
  student      Student @relation(fields: [studentEmail], references: [email])

  @@map("schedule_item")
}

model YearlySchedule {
  id           Int           @id @default(autoincrement())
  year         Int
  studentEmail String
  monthlyData  MonthlyData[]
  student      Student       @relation(fields: [studentEmail], references: [email])

  @@unique([studentEmail, year])
  @@map("yearly_schedule")
}

model MonthlyData {
  id               Int            @id @default(autoincrement())
  month            Int
  days             Int[]
  startDate        DateTime       @default(now())
  yearlyScheduleId Int
  yearlySchedule   YearlySchedule @relation(fields: [yearlyScheduleId], references: [id])

  @@map("monthly_data")
}

model Progress {
  id           Int      @id @default(autoincrement())
  date         DateTime
  type         String
  title        String
  description  String
  studentEmail String
  student      Student  @relation(fields: [studentEmail], references: [email])

  @@map("progress")
}

model Evaluation {
  id           Int      @id @default(autoincrement())
  date         DateTime
  label        String
  scores       Json
  studentEmail String
  student      Student  @relation(fields: [studentEmail], references: [email])

  @@map("evaluation")
}

model Award {
  id           Int      @id @default(autoincrement())
  title        String
  prize        String
  level        String
  year         Int
  studentEmail String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  student      Student  @relation(fields: [studentEmail], references: [email])

  @@map("award")
}